import Collections
import Foundation

struct Day4Solver: DailySolver {
    public typealias CalculationInput = Grid<Int>
    
    public func parseInput(_ input: String) -> CalculationInput {
        let inputLines = input.components(separatedBy: "\n")
        var wall: Grid<Int> = .init()
        
        for (y, line) in inputLines.enumerated() {
            for (x, char) in line.enumerated() {
                if char == "@" {
                    wall[x, y] = 0
                }
            }
        }
        
        for rollLocation in wall.points {
            wall[rollLocation] = wall.getNeighbors(of: rollLocation).count
        }
        
        return wall
    }
    
    public func calculatePart1(_ input: CalculationInput) -> Int? {
        return input.getPoints(where: { $0 < 4 }).count
    }
    
    public func calculatePart2(_ input: CalculationInput) -> Int? {
        var wall = input
        var removable = OrderedSet<Pair>(wall.getPoints(where: { $0 < 4 }))
        var removed = [Pair]()
        
        while removable.count > 0 {
            let point = removable.removeFirst()
            
            removed.append(point)
            wall[point] = nil
            
            for neighbor in wall.getNeighboringPoints(of: point) {
                guard let count = wall[neighbor] else {
                    continue
                }
                
                wall[neighbor] = count - 1
                if count - 1 < 4 {
                    removable.append(neighbor)
                }
            }
        }

        return removed.count
    }
}

//MARK: - Inputs
public let day4Inputs = DailyPuzzleInputs(
    part1Example: testInputString,
    part1ExampleAnswer: 13,
    part2ExampleAnswer: 43,
    puzzleInput: puzzleInputString
)

fileprivate let testInputString = """
..@@.@@@@.
@@@.@.@.@@
@@@@@.@.@@
@.@@@@..@.
@@.@@@@.@@
.@@@@@@@.@
.@.@.@.@@@
@.@@@.@@@@
.@@@@@@@@.
@.@.@@@.@.
"""

fileprivate let puzzleInputString = """
@..@@.@.@@@....@@..@@@.@@@@@@..@..@@.@.@@.@@...@.@.@...@@.....@..@@.@@@@.@@@.@@@..@.@@@@@@.@@@@@@@@@@...@@..@..@@.@@@@@@..@@@...@.@@@@@@
@.@@.@@@@@@..@.@@@@.@@@@@@.@.@@@@..@@@@@@@@.@.@@@...@.@@@@@@..@..@.@@@.@@@@.@@@@.@@@@@@@@@@@..@@@@@@.@@.@@.@.@@@@.@@@@@@@@@@...@.@@.....
@@.@@@@@.@.@@.@@@@@@@@..@@@@@.@@.@@.@@@@.@..@@@.@.@@@@@@@@.@.@@@@@@@@@@@...@@@@@@.@@@@@@@.@@@@.@@.@@.@@.@@.@@.@@@..@@..@@.@@@@@@.....@.@
@@@@.@..@@@.@@.@@.@@.@@@@.@.@.@@@@@@@.@@.@@@...@.@@.@@@@@@.@@@@@.@@.@@@@@.@@..@.@@@@@@@.@@@@.@.@@@.@...@@.@@@@.@.@@@@.@.@.@@@@.@@.@@@@@.
.@@@@.@@@.@@.@@@.@@.@.@.@@..@.@@..@.@@.@@@@@@@@.@.@.@.@@.@@@@..@@.@..@..@.@@@@@@@.@@@.@.@@@@@..@@@@@@@.@@@.@@.@@..@@...@@..@.@@@.@@@@@.@
@@@@@@@.@@.@.@.@@@.@@.@@@@@@@@..@@@@.@@.@@@..@@..@@@@@.@@@.@.@.@..@...@@.@..@@@.@.@@.@.@.@@.@@@@@@.@..@.@@@.@..@..@@..@@@@.@@.@@@@@@@.@.
..@@@.@@.@...@.@@@.@@.@.@@@@@@@@@.@@.@..@.@@@.@@@@.@.@.@@@.@@@.@.@@@@@@.@@.@...@@@..@@.@.@.@@@.@@.@.@@@..@.@@@@@..@.@@.@..@.@@.@...@@@..
@@.@.@.@@..@@@@.@.@@.@@@@@@@@.@.@@.@.@@@..@..@@@@@@@...@@@@@@.@@@@@@.@.@@@@@@@@...@.@@@@@@@@@@@.@@@..@.@.@@@.@@@.@..@@@.@..@@.@.....@@.@
@@.@.@@@@.@@@@..@..@.@@.@@.@@..@.@@@...@@@.@@.@.@@@@..@@.@.@@@.@@@@..@@@.@.@@@..@@...@@.@....@@@.@@@@@@@..@@.....@@.@@@@..@.@@@.@@@.@@@@
@.@@@@..@@@@..@..@@@@@@.@@..@.@.@@@@@..@@@.@@@.@.@@@@..@@@@.@.@@.....@@@@@@@@@@.@..@@.@@@@@@@@.@@@..@..@.@@@@....@.@.@@@@.@@.@.@.@.@@@@.
@.@@....@.@@@@@..@@@@..@@.@@@.@@@.@.@..@@@.@@.@@.@@@@@@@@.@@@.@@.@..@@@@..@@@@@@@@@@.@@@...@@@@.@@.@@@@@.@@@..@@..@@.@@@.@@@@@@@@.@@.@@@
@@@.@@.@.@.@.@@.@@@..@@.@..@@@..@@@@..@@@@..@.@@@@@@@.@@@@..@.@@..@@.@..@@....@@@@@@@@@@@@@.@..@@@@..@@@@@.@@@.@...@@.@..@.@@@@@@@.@@.@@
.@...@.@@@.@@@.@.@@.@...@@.@@.@@.@.@@..@@.@.@@.@.@@@@@@@.@.@@@@.@@@@@@@.@@@..@@@@@@..@@@.@@.@.@..@@@@@..@.@@@@...@..@@@@@@@.@@@@@@@.@.@@
@@@@.@.@.@.@.@.@@@@@@.@@@@@@@..@@@@..@@.@....@..@.@@..@@@@@@@.@@@@@@@@...@@@..@@@@..@@@@@.@@@@.@@..@@.@@.@@@@.@@..@@@@@@@@.@@.@@@@@...@@
@@.@.@@@..@....@@@@@.@@..@@@...@...@@@.@@@@@@..@@@@@@@@.@@@@@@..@.@@...@.@@.@..@@..@@@@.@..@..@@@.@.@@@.@.@@@@@.@@@@@.@.@@..@@@@..@.@.@.
@.@@@@.@..@@.@..@.@@.@.@@@@..@.@.@..@@@@.@@@.@@.@@.@@@@@@.@......@..@@.@@@...@...@@@.@@@.@@.@@@.@@..@.@.@@@@..@@@@@.@@@@@@.@@..@@@@@@@@@
@.@@@@@@@@.@.@@.@.@.@...@@@@@..@@.@.@@@@@@@.@@...@@....@@@..@@.@@@@.@.@@@@@.@@@@.@@..@.@@@....@@.@.@@@.@@@@@.@@@@@@.@@@@@..@...@....@@@.
@.@@@@.@..@@@@@@@@@@@@@@..@@@@...@@@@@@@@..@@@@@.@@@@...@@.@@@@.@@@@@@@.@@..@.@@..@@@.@......@@@@@@@@@@.@@@@@@@..@@@@@..@..@@@@@@.@@@@@.
@@..@@..@@@@@@@@@@.@...@@.@@@@@@@@..@..@@@.@.@.@.@@.@@@@@@@@@@@..@.@..@@@.@....@@@.@@@@.@.@@@.@@@.@@..@@@.@.@@@@@..@@.@...@@@@@@@.@@@...
@..@@.@@.@@@@.@..@@.@@@@@@@@.@@.@.@@@@@..@.@@.@..@.@@.@@@@@@@@@@@...@.@@@.@@@.@.@@@@@@@@@@..@.@@@@@@..@@@@@.@.@@.@@@@..@@@@@....@@..@@.@
..@@.@..@@..@@.@.@.@@@.@..@.@@@@@@@@@..@@@@@.@@@@@@.@@.@@.@..@@@@@@@..@...@..@@..@@.@@@.@..@@@@.@..@@@.@@@.@@@.@.@@@@@@@.@.@.@@@.@@@@...
...@@....@.@@@@@@@@...@@@@@@@.@.@@@@.@@@...@@@@@@@@@@@@@@@@@@@@@@@@.@..@@@@@@.@@@@..@@.@@...@@@@..@..@@@@@@@...@.@@.@@.@@..@.@.@.@.@@@@.
.@@@.@@@.@..@@.@.@..@.@@...@@.@@.@.@@..@@.@...@..@@@@@@..@@@@.@@.@..@@@.@@.@.@.@.@@.@@@.@@@.@..@.@@@.@.@@@..@@.@.@@@.@.@@@@@.@@@@@...@@@
@@.@..@@.@@@@@@@@@@@@...@@.@@@@.@@@@..@..@..@@@@@@@.@.@@..@@@.@@@.@@@@@@@@@@@.@@@@...@@.@.@.@@..@.@@.@....@..@@.@.@@..@@@@@@...@@.@@@.@@
@.@@.@@.@@@@@..@..@@@@@@@@..@..@@.....@@@@.@.@@@@@.@@@.@@@@@@.@@@@.@.@.@.@@.@.@@.@@.@@@@@.@@@.@..@.@@...@.@@@@@@@@@..@@@...@.@.@.@.@@@@.
.....@@@@@@@.@@.@.@...@@@..@..@@.@@@@.....@..@.@@@@@.@@.@@...@@.@.@@.@@@.@@@.@@@@@@.@.@@@@@@..@@@@@@@@...@..@.@..@@@..@..@@.@....@@@@@@@
@@@@.@@@...@@.@.@@.@@.@.@@.@@@@.@@@@@@@@@@.@@@.@..@@.@@@.@@.@..@..@@@@.@..@@@@.@@@@...@@.@@.@..@@@@@@@.@@..@@@.@@@@@@.@@@.@@@...@.@@@@.@
.@.@@.....@.@@@@@@@...@..@@.@@..@.@.@@..@..@@..@@@@@@@...@@..@@@.@.@@@..@@.@@...@@..@@@@@@.@...@..@.@@@@@@@@@.@@.@@.@...@@@@@@@.@@@@@..@
@.@@@@@...@.@@@@@@@...@@.@.@@@@@@.@@@@@@..@..@.@.@...@@....@@@.@...@@@@@@....@@@..@@@@.@@..@.@@@@....@@@@@@@@@@@@@.@.@@.@@@@@@.@.@..@.@@
@@@@.@@@@@.@..@@@@@@@.@@@@@@@@@@@@@.@.@@.@@@@.@@@@@..@@@@@@.@....@@@@@@@@.@@@@@@.@.@..@@@@.@.....@.@.@@@@@@@@@@@@@@@@@@@@@...@@.@@.@.@.@
....@.@@@@...@.@@.@.@.@..@@.@.@@.@@@@@@@@@@@@@@@@.@@.@.@@@@@@@@.@@.@@@@.@@.@@@@@.@.@@@.@.@.@.@@@@..@..@@@.@@...@@.@...@@@@..@@@..@@@@@.@
@.@@@@..@@@..@@@@...@@@@@@@.@@.@@@..@..@.@@@.@@@@@@@@..@.@.@..@@@@..@@..@@@..@@@@....@....@.@@..@@.@@@@@@.@@@@..@.....@@..@@@@@@.@@@.@@@
@@@@@@.@@@@@@.@.@@@@.......@...@.@...@@.@...@@..@@@...@@@.@@@@@@@@@@@.@.@@@...@.@@@@@@@@@.@@@@@@@@..@.@@.@@..@.@@@@@@.@..@..@.@.@.@@..@@
@@@@.@@.@.@@.@@@@@@@.@@..@@..@@@.......@@.@.@.@@@@@.@@@@.@@.@@@....@@.@@@@@.@@.@@@@..@@@@.@@@@@@@@@@@@@@@@.@.@.@.@..@.@.@@@@@..@@@@.@@@@
@@.@@..@@@@@@.@@@..@.@.@.@.@@.@@.@@.@@@@@@@@@@.@@.@.@..@@@.@@@.@..@...@@@.@@@@@..@...@@@@.@@@@@@@@.@@.@@.@@@@.@@.@@@@..@@@....@@..@.@@@@
@@....@@..@..@@@@.@@@.....@@.@.@@.@.@.@@.@..@@@@@..@.@@@..@@.@@@.@@@....@@@..@@@@.@@.@.@..@@@....@@.@.@..@@@@@@@.@@...@..@@.@@.@.@@....@
..@@.@.@@.@.@.@@@@.@@@@.@.@@@@@@.@.@.@.@@.@@...@.@@@@@@@.@@@@@.@@@@.@@@....@..@@@..@@@.@@@@@@.@....@.@...@.@.@.@@@@@@..@@@@@@@.@..@@@.@@
@@@@@@@.@@.@@@@@...@@@@.@@@.@.@@@.@.@.@.@@@...@.@@@@.@@.@@@@@@.@@@@.@.@@.@@.@@@...@.@.@...@@@@@@@.@@@@@@.@@..@@@@@@@@...@@.@@@@@..@@@@.@
@.@@.@..@..@.@@@@@.......@..@@@..@@@.@.@@@....@@....@.@@@@@@@@..@@.....@@@@@.@@.@@@@@@@..@@@.@..@@.@@.@@@@.@.@.@@@@@@.@@.@.@@@.@@..@..@.
@@@.@.@@.@.@@@@..@.@......@.@@@..@@@@@.@..@@@@@@.@.@.@.@.@.@.@@.@@@@@.@.@@@@@...@@..@.@@.@@.@@..@@@@@@@@.@@@@.@.@@@.@@@@.@@.@@@@@@.@.@@@
@..@@@@.@@@@@.@..@@.@..@@@@@@@.@@@@@@.@@@...@..@.@@@@..@@.@@@@@.@.@@.@@@@@.@@@@@@@@@..@@@.@.@.@@.@@@@.@@@@@@@..@@@.@@@@@@@.@@@@@@@.@@@@.
.@.@@@.@@.@@@@.@@@@@.@@@@@.@.@@@@@.@@....@@@@@.@@.@@@..@@@@@@.@@@@@.@..@@...@@@@@@@@...@.@@@@@.@@@@@@@@..@@@@@@@@..@@..@@..@@@.@@.@.@@.@
@@.@.@.@@..@@@.@...@@@@@@..@.@@.@@@@@..@@@@@@@.@@@@.@.@.@@.@@@.@@@@@@@.@@@@.@@@@@..@@@@.@@@.@@@@@@@@@@.@..@.@@@@.@.@@@@@..@@.@@@@.@.@@@@
@@@..@@..@@@@@@@@@@.@.@.@@@...@.@@.@@@.@@@@@@@@@@@@@@@.@@@@@.@...@..@@.@@@.@@@@@...@.@.@.@.@@@@.@.@@..@@@@..@.@@@@.@@.@@.@.@@@@.@@.@..@@
...@@@@@@.@@.@.@@.@@@..@@@@@@..@@...@.@.@..@.@..@@@.@.@@@@@@@@@.@@.@@.@@@@@@..@@@@@@@.@@@@...@@@@@@@.@@.@@@.@@@@.@@@@..@@@...@....@@@.@@
@.@@@.@.@.@@@@.@.@@@.@..@@@@.@@@@.@@.@@..@@@@.@.@@.@@....@@@..@@.@@@@@.@@.@@.@.@@..@@..@@@@@.@..@@.@@@@@.@..@.@@@@@@.@.@@@@@@@@@@@@@@@@@
@.@@@.@@.@@@@..@.@.@..@@@@@...@@@@@@.@@@@.@.@@@@@@.@@...@.@@@..@.@@.@@.@@..@@..@@@@@@@@@..@.@@@@..@...@@..@.@..@@@....@@.@@@...@@@@@@.@@
@@.@@@@.@@@@.@@.@..@@.@@@@.@@@@..@@@.@@@@@@.@.@@@@@..@..@..@@..@@.@.@@.@@@.@..@@@.@@@@@@@.@@@@@@.@@.@@..@.@@@@@.@@@..@@.@.@.@....@@@..@.
@.@@.@@.@@.@@@.@@@@.....@.@@@.@@@..@.@@@@@@....@@.@@@@@@@..@@.@@.@@@@@.@@@..@@@.@@@.@.@@.@@@@@@..@.@....@@@@@.@.@@@@@@@.@@@@@.@@@@@@@.@@
@@@@.@@@@..@..@@@@@@@@.@@@@@...@@@.@@.@@@.@.@..@@@@@@.@@.@.@@.@..@@@@.@@@@@@@@@@@@.@@@@.@@@@.@.@@@.@@@@@@.@@@@....@..@@.@@@..@@@@...@..@
@@@@@.@.@@@..@.@.@....@@@@@..@@@@@@@.@@...@@@@@@.@@@@.@@@.@@@@@.@.@@.@@@@.@.@@@@@@@@@@..@.@@@.@.....@@@@.@.@@@..@@@@@.@.@@@@@@@.@@@@@.@.
@@@.@@.@@.@...@@.@@@@@@@@@@@.@@@.@.@..@..@.@.@@@...@@.@@.@.@@.@.@@@@@@..@.@.@...@.@.@.@..@@@@.@.@@@@@@@.@@@@@.@@.@@..@.@.@@..@@@.@@@@@.@
@@@@.@@.@@...@@@@@@...@.@@@@@@@@@.@@@@@@@@.@@@@@@.@@@@.@@.@@@@@.@@...@@.@...@@@..@@...@.@@@@@@.@....@.@@..@@@@..@.@.@@.@@@..@@.@@@.@.@..
...@@@@@@..@.@@.@.......@..@@..@@@.@@@@@..@.@.@@@@.@@...@...@@.@.@@@..@@.@@...@.@.@..@@....@@@.@..@@@@@..@@@.@@@@..@@@..@@@@@.@@@.@..@@.
@.@@.@..@.@@@@@.@@.@...@.@@.@.@..@@@@.@.@@@..@..@..@@.@@@@@@.@...@..@@@@@@@@.@@..@.@@@..@@@@@@@.@...@@@@.@.@@@@@@@.@..@.@@.@@..@@....@.@
.@.@@.@.@@.@@@@@@@@..@@@@.@@.@...@@..@@@@@@@@.@@@@@@@@@@@@@@@.@@@.@.@@@@@..@@.@@@@@@..@@@@@@@@@@.@@.@@.@@..@@@.@@.@@@.@..@@.@..@..@@.@.@
@.@@@....@.....@.@@@@..@@.@.@.@@@...@@@@@@..@.@.@@@..@@@@..@@@@@.@@@@@@.@@@@.@@.@@.@@@@@.@@@@@@@@.@@@.@@..@..@.@..@.@@@.@@@.@@@@@....@@@
@@.@..@@@@@@......@@@@.@...@.@.@@@.@.@@.@@@..@.@@@@@.@@@@@@@@@.@@@@.@.@@.@@@@@@@.@@@.@@@.@@.@@..@....@@@@@@@@@@@@@....@@@@.@.@..@.@@@.@.
@...@.@.@@@.@@..@@@@.@@@.@@.@..@@.@@..@@@@@@....@.@@@@.@@.@.@..@@@@..@..@..@@@@@@@@@@@@@.@@@@@@@.@@.@.@@@@@..@@@@.@@@@..@@@.@@.@.@@.@@@.
@@..@@@@@.@@@..@..@@@@@@@@@@@@@@@..@.@@.@@.@.@@@@...@.@@@@@@@@@@.@..@@@@@@@@@@@@@@@..@@@@@...@.@@..@..@@@@@@@@...@@@@.@@@@.@.@.@@@@@@@@@
@@.@.@@@.@.@@@@@@.@@.@@@.@@@...@@@..@@@@..@.@@@@@@@@.@@@....@@.@@@....@@@@@@@@@@.@.@@...@@.@@@@@@.@@..@@@@.@.@@@.@@.@@@.@@@.@@@.@@@..@@@
@.@..@@..@@@@.@@@..@@.@@@.@.@@@@@@.@....@..@..@@@@@@..@@@@@@@@.@.@@@@@..@@..@@@.....@@@.@.@@@@.@@.@@..@@@@...@@.@@@@...@.@@@@.@@.@@@@.@@
@@@@@.@.....@@@..@..@@..@.@....@@...@.@@.@@.@@@@@.@..@@.@@.@@..@@....@.@.@.@@....@@@..@..@.@@@@.@...@@..@@@.@@@..@@@.@.@@.@@@.@@@.@@..@@
@@@@.@@.@..@.@@@.@@@@.@.@@@@@@@.@@@@.@@@@.@..@@@@@@@@.@.@@.@.@@@.@@@@@.@@@@..@@@@@@...@.@@.@@@@@@@..@@..@@@.@@.@.@@@.@@.@@@@@....@@@@@..
.@@@.@@.@@@..@.@.@@.@@@.@@@@@@@@@@@@@.@..@@@..@@@@..@@.@@@.@@@@@@@@@@..@...@@@@@@@@@@.@@@@@@@@@@@...@....@@@..@@@@...@..@@@@...@@@@.@@..
@@@@@....@@@@@.@@@.@@.@.@@@@@...@.@@@.@@@@.@@@@@...@@@@@@...@@..@@.@@@@@.@@.@@@@..@....@@@.@@.@.@@@.@@@..@@...@@@..@@.@.@@@@@@@@.@.@.@.@
...@@@@.@@.@@.@@@@.@.@@@@@..@.@...@@@.@@@@@@@.@.@.@@@....@@@.@.@@.@@..@@.@@..@@@@..@.@@@@.@@...@.@@.@@@@@@@..@@..@@.@@.@.@@@@@@@@@..@@.@
.@@@@@..@@@@@@@@@.@.@@@@.@@....@@@@@.@@@@.@.@@@.@@@..@@@...@.@@..@.@.@@@.@.@@.@@.@@@@@@..@.@@.@@@@@..@..@@@@@...@.@@@@.@@@@@.@..@@.@..@@
@@.@.@@@@@@.@@@.@..@@.@@@.....@....@@.@@@@@@@@@@@@.@..@@.@...@.@.@@@@@@.@.@@@@@@@.@@@.....@@.@.@@@@@.@@.@.@.@.@@..@@@@@@@@.@@@.....@.@@@
@.@..@.@.@@@.@@.@@@.....@.@@@.@@@@@..@@.@@@.@@@@.@.@.@@.@...@..@@...@@@@.@.@@@.....@.@@@@@@@...@.@@@@@@.@@@..@@@@.@@@.@@...@.@@.@...@.@@
.@@.@@@@@@@@@@@..@@@.@@@@@@.@@@@.@@@.@@@@..@@@@@@.@@@@@@@@@@.@..@@...@@@...@@@@.@@.@.@.@@@.@@@@.@.@.@.@.@@@@..@@@@@...@@@@@@@@@@.@@.@...
..@@....@@....@@.@@@@@@.@@@@@@.@..@@@@@@@@..@@@@...@@@@@@@@.@...@.@@@@@@@@.@.@@@.@.@.@@@@.@@.@.@@@..@...@@.@.@@@@@@@.@@@..@.@@.@@.@@@@@@
@@@@@@@@..@..@@@.@.@@@.@@..@..@@@@@...@@@@@@.@.@@..@.@..@@@@..@..@....@@@.@...@...@..@@@@..@.@@@@@@@.@.@@@@.@@.@@@@@@@.@@@@.@@.@.@@@..@@
@.@.@.@..@@.@@..@@@@@@.@.@@@@@.@@.@@.@..@@@@...@@.@@@@@@.@@@@@@.@@@.@..@@@@.@@@@.@.@@.@@.@@@@@.@@..@@@@@@.@@@@.@..@@.@@@...@@@@.@@.@@@..
@@@@@@..@@.@...@.....@@@.@.@@@@@@@@@@..@.@.@..@..@@@...@...@@.@@.@@@@@@.@@.@..@@.@@..@@@..@@@@..@@@@@@@@..@@@@@@.@@.@...@.@..@..@..@@.@@
@.@.@.@...@@@@@@@@@@@@..@@@...@@@.@@@@@@@.@@.@@.@.@.@@@@@.@@.@.@@.@@@@@@@@@....@.@@.@..@@@.@@@..@@@.@.@@@@@@.@....@@....@..@@@@..@@@@@@.
@@@@@@..@....@.@..@@.@@..@.@.....@.@@@@@.@@@@...@@@@.@.@@@...@@@@@@@@@.@@.@@@.@@@.@@@@.@.@@.@@.@..@.@@@@@.@.@.@..@@.@@@.@@@...@@@..@@.@@
@..@@.@@@@@@@.@@@.@..@.@@@.@@@...@@@@...@.@@@@@.@@..@@@..@@@.@@.@@.@...@@@@.@@@.@@@@@@.@.@@@@@@.@..@@@....@@@...@@@@@@..@@@.@.@.@@.@@@.@
@.@@..@.@@@@.@@@@@..@@@@.@@@.@@@@@.@@...@@.@.@@.@@@.@@.@@@@..@@@.@..@@@.@@@@...@@.....@@@@@..@@@@.@@@@...@.@@..@@@@@..@..@@@..@@@..@.@@@
@..@@.@@@@@.@@@@@@.@@..@.@@@@@@..@...@@@@.@@.@@@@@.@@@@@@@.@@.@@...@@.@@@@.@.@@.@@@@.@@@@@.@@@.@.@@@@@@.@@@.@@@@@.@..@.@@@...@.@@.@...@@
@@@@@.@@@@@@@@@@.@..@@@...@@.@.@@.@@.@@@@@....@@@..@..@.@..@..@@.@@...@@.@@@.@@.@.@.@@@@@.@@@@.@...@..@@@@@.@@@@.@@.@@.@@@.@.@@@@.@@@@@@
.@..@@@.@@@@@@@@@@.@@@@@@@.@..@@.@@@.@.@@@@@.@..@.@@....@@@@.@@@.@@..@@@@@@@@.@@@..@.@.@.@@@@.@@..@.@@@@@@@@@@@@@@@@@...@@@.@.@@@@..@@@.
@@@.@..@@.@@@@..@.@@@.@@@.@@@@@.@...@@.@..@@@@@.@..@@@.@@..@.@.@@@@....@@@@@..@@@.@@.@.@@@.@@.@@..@.....@@@.@@.@@@..@@@.@.@.@@@@..@@..@.
@@.@@@@@@..@@@@@@.@@@@......@.@@@@@.@.@@@.@..@@....@@...@...@.@.@@@.@..@.@.@@@.@@.@@@@@@@...@@.@@...@.@@@@.@@@@@@@@@.@@@.@..@@.@@.@@..@@
@@@.@@.@@@@@@.@@@@@@.@@...@....@.@@@@@.@....@@@@....@@.@@@.@....@@@@@@.@@@..@@@..@.@@.@@@.@.@..@@.@.@..@@..@@.@.@.@@@.@@.@@.@.@@.@@.@@@.
.@.@...@.@.@@.@@@.@@..@..@@.@@@..@@@@@.@.@@@....@@.@@.@@.@@@.@@@@@.@@..@@@@@@....@@@@.@@.@@.@@@.@@@.@@@.@@.@@.@.@@@.@@@@@@@@@@@@@@@@@@@@
@@..@@@@@@@.@@@@@..@.@@.@@@@.@@@@@@@.@.@..@@..@.@@.@@@@@@.@@.@@@.@..@@.@@@@@@.@@@.@@@@@..@.@.@@..@@@.@@.@.@@@@.@.@@@@.@.@.@.@@@.@.@@@@@@
.@.@@@@.@.@.@@@@.@@.@.@@..@...@..@@...@.@@.@.@@@@@@@@@@@.@@@.@@@.@@.@@@@@@@@...@@.@.@..@@@@@@@.@.@@@.@@@.@@@@@..@@@@@.@@@..@..@@.@.@.@@@
@@@.@@@@@@.@@.@@@@@.@@@.@@@@.@@@@@@@@@@@@@.@@.@.@@.@..@.@@.@@@..@.@@..@.@.....@.@@@@@.@@@@..@@@.@.@@@@@@@@@@@@.@@@@@.@..@@..@@@.@@@@.@..
@.@@..@@.@@@.@@@@@@..@@@.@@.@@@.@@.@@..@@@@.@@@..@@@..@.@@@@@.@.@.@..@@@.@.@@....@@.@@..@@@.@.@@@@@@.@@.@.@..@@...@@.@..@@.@@@.@@@@@.@@@
@@@@.@@..@.@@.@@@@@@@@@@@..@@.@.@..@.@.@@@@..@@@@@@@.@@@.@@@@@@@@@@@..@.@@@@@@.@@@.@@@@@.@@@.@.@.@@@@@@@@.@@@@.@@@@@@......@@...@@..@@.@
@.@.@.@.@@@@.@@@@.@@@@@.@@..@@@@...@@@.@@.@@.@.@@@.@@.@@@@....@@@@.@@@@@@@@@.@@@.@@@@@..@.@.@@.@.@..@.@..@@@@.@@.@@.@.@.@..@@@@@@@.@@@@@
@@..@...@@@@@@..@@@@@@@..@@@@.@@@@.@.@@..@.@....@@@@@@.@@.@.@@@.@@@@@@@@@.@.@@..@..@.@@..@@.@@...@@@.@.@..@@@@@@@.@@@@@@@.@@@@.@@.@@.@..
@@....@@@@@@@.@@.@@..@@@.@.@@.@@.@@@@@@@.@@@@@@@.@.@..@@@@.@...@.@@.@.@@@.@@@@.@@@@@.@..@@@..@@.@@@@@@@...@@@@@.@@@@.@.@@..@@..@..@@...@
@@.@..@@@..@.@@@@@@@@.@@.@..@@@@@@@.@@@@..@@.@@@@.@.@@@.@.@@@@.@...@.@@@@.@.@@@.@.@@..@.@@@@@@@@@@...@.@@.@@@@.@..@@@@@@@..@@.@.@.@@@@@@
@.@.@@@.@@@@@@@@@@.@.@.@.@..@@@@@@.@@@@@@@.@.@@@@@.@@@.@@@@@..@@@.@@@@@@@@@@@@@@@.@@@@@@.@@@@@@...@.@@@@@@..@..@..@.@@@@@@@.@.@@...@.@.@
.@@@@@.@..@.@.@@@@@.@@@@@@@.@@@..@@@..@@...@.@@@@@.@@..@.@@.@.@@@@@@@@@.@@.@@@@@@@..@@.@.@@..@@..@.@@.@@@@@@.@@.@@@@@@@@@@.@@@.@@@...@@.
@.@@..@@..@@@.@.@@@@.@@@.@@@@...@@@@@@.@@@@@.@@.@@..@.@.@@@.@@.@@@@..@...@.@@@..@@@@.@@@@..@.@..@@.@@.@.@...@.@...@@@@.@@@@.@.@.@@@@@.@@
@@.@@@.@@@@@.@@..@..@.@@..@..@@...@@@@....@@.@@@.@@@@@@@@.@..@@@.@.@@@.@@.@.@@.@@@@.@.@.@@@@@@@@@@.@@..@.@@@@@@...@@@@@@@@@@@@@@@@@...@@
.@.@@@@.@...@@@@...@@@..@@@@@..@@.@@..@@@.@@.@.@@@@@@@@@@@.@@.@@.@.@@@@.@@@....@.@@.@@.@@.@@.@.@..@@@.@..@..@.@@@@@..@.@@.@.@@.@@@@@@@@@
@@@..@@@.@@@@@@..@.@@@@.@@@@.@.@@@@@@...@@.@.@@@@..@@@.@.@@@.@.@.@@@..@@.@@@@@@@...@@.@@@@@@.@@@.@@@@.@@@.@@@@@.@@@@...@.@.@..@@@@@@@...
...@.@@@@@.@@@@@@@.@@@...@..@@@@@.@@@@.@@@..@@@@@.@@@@..@.@.@@@@.@@.@.@@.@@@.@...@.@.@@@@.@@.@..@@...@@..@.@.@@@@.@.@..@@@..@@.@..@.@@@@
@@.@.@@..@.@..@@@@@@@@@.@...@@@.@.@...@@@.@@@@.@@.@@...@@..@@.@@.@@.@.@.@@@@@@@@..@@@@..@@@@..@...@@.@.@@@@.@@@@@...@@@...@.@.@.@@.@@@@@
@.@@.@.@..@.@@@.@@@@.@@@@@@@.@.@.@@@@@.@@@.@@.@@@@..@..@@.@.@...@.@@@@@@@.@..@..@@@.@@.@.@@.@@.@@.@@@@@@@@@@@..@@..@.@@.@@@..@.@@@@@@@..
@@.@@.@.@@.@@.@@.@@@...@@@.@..@@.@.@@@@@@.@.@.@.@@..@.@@.@@@@@@..@@@@@.@..@.@.@@@@.@@.@@@@@@@@@.@@.@@@@@@@@..@@.@.@@@.@.@@.@@@.@.....@.@
@@..@@.@..@.@@@@..@@.@@..@@@@@@@@@@@.@@.@@..@.@@@....@..@.@@@@.@@@@@@@@..@@.@.@..@.@@@@@@@@@@@@.@@.@@.@@.@.@.@@@@...@..@@@.@@@@@@@@.@.@@
.@..@@@.@@@.@.@....@.@@.@@..@@@@@@@@@.@...@@.@@..@@@.@.@@..@.@@.@...@@...@@@@@.@@.@.@@@@@@.@.@@..@@@@@@.@@.@.@@@@.@@@@@.@.@@@.@...@@...@
@.@@..@@@@.@@.@@@@@.@@.@..@@@@.@@@@@@@@@.@@.@@@.@@@@.@@@.@@@@@.@@.@@...@.@@@@@@..@@@..@.@@@@@.@.@@@@...@@@@@.@.@@.@@@@@.@@@...@.@@@@@.@.
.@@...@@..@...@@@.@..@.@@@.@@.@..@@@.@@..@@@@@.@..@@@@.@@..@@@.@@..@@@...@@.@.@.@..@@@@@.@@@...@@@@.@.@.@.@..@.@.@..@@@@@@@..@@@@@.@.@@@
@@@@.@@@@...@.@@.@@@@.@@@@.@@@@@@@.@.@@@@@@..@.@.......@...@@.@..@.@@.@@..@.@@@@@.@@@@.@@...@@.@@...@.@@..@@@.@@.@.@@@@@@@@..@..@@@@@.@.
@.@@@@.@.@@@.@@@.@.@@.@@@@.@.@@@.@.@.@.@.@@@@@@..@.@.@@@..@.@@@@@@..@@@@@@@@@@@@.....@@...@..@@@@@@@@@@.@@@..@.@...@@.@@@...@@@.@@@@..@@
@@@..@.@@.@@@@@@.@@.@@.@@@@.@@@@@@@@.@.@.@@@@@.....@@@.@@.@@@@@@@@@@.@@.@@..@@@.@.@@@@.@.@@@@.@@...@.@..@@.@@@..@....@@@@@.@@@@.@@@.@@@@
....@@@@@..@@@.@@...@@.@@@@.@@@.@..@@..@@@@.@..@@@@.@@.@@.@@@@@@.@@...@@@@.@@@@.@.@@@@@.@@@@..@@.@@.@@@.@..@@@@@.@@@@@.@@@@@....@.@@@@@@
@.@.@@@@.@@..@@@@@@@@@.@.@@.@.@@@.@@@@.@@.@@..@@..@@@.@@.@@@@@@.@...@...@@..@.@@..@@@@@@.@@..@@@...@.@.@@..@@@@...@@.@@@..@@@@@@@@...@..
@@.@@.@.@@@@..@@..@@@@@@@@@@@.@@..@@.@@.@.@@.@.@@....@@@..@@..@@.@@@..@@.@@.@.@@@.@@..@@.@@@...@@@..@@..@@.@..@@..@.@@@.@@@..@.@@@@@@@..
.@@@.@@@@@@@@.@@..@.@.@@@@@@@@@@@@@.@@.@@.@@@..@....@@.@.@@@@@.@..@@..@@@@@@.@@@@..@@..@@..@@.@@@@..@.@@@.@.@.@@@@@@..@.@.@.@....@@@@@@@
@@@@.@.@@@@.@.@.@@@.@@@@@@@@@@@@...@@@.@.@.@@@.@@@@@@.@@.@@@.@@..@...@@@@@..@@.@@..@@@@....@@@.@@.@@@@@@@@.@.@@@@@@@..@@@@@@.@@..@@.@@@.
.@..@@@@.@.@@@@.@....@@..@@..@@@@..@@@@@@@@@@@@@@@@@.@@@..@@@@@@@@.@.@@@@@..@@@..@...@@.@...@@@@....@@@@@..@..@@@.@@@@.@..@@@....@@@...@
..@@@@@.@.@@@@@@@.@@.@@@@@@@@@@@@@..@@@@@@@..@@@..@.@.@@.@@@@@@@@@@@@@@@@...@@@.@@@@@@@@.@@@@@@@.@@.@.@.@..@.@..@@.@...@.@...@.@@.@.@@.@
@@@@....@.@.@@..@@@@@@.....@@@@.@.@.@@.@@@.@@@@@..@..@.@@@..@@.@@@@...@.@@.@@@..@.@.@@@@.@@@.@.@@@@@...@.@@@.@@..@@@@@.@@..@@@@..@.@@@..
@@..@@.@.@@.......@@@@@@@@@@@@@.@@@@..@@@@@@.@@@@.@.@@.@..@@@@@@..@@@...@@.@.@.@@@@...@@@@@@@.@.@@..@.@@@@@@@.@.@@.@.@@@@@.@@@@@@@@@@@.@
@@@@@..@..@@.@@@..@.@@@@.@.@@@@.@@@@@@@@@@...@@@@@@@..@.@@@..@@.@@@@.@@@...@...@@@@@.@@.@@@.@...@@@.@@@..@@@...@.@@@@..@@@@@@@@@@.@@@@@@
@@@@@..@@.@@@.@.@@@.@.@.@..@@@@..@@@@@..@@.@@@@@.@@.@.@@@@@@@@.@@@.@@..@..@@.@.@@.@....@@@.@..@..@.@@@.@@@.@..@.@@.@@@@.@@@@@@...@@@@@@.
.@@@@.@.@@.@@.@@@..@@@..@.@@...@@.@@.....@.@@@@@@@.@@@@.@.@@@.@@@..@@.@.@@@@@@.@.@@@....@...@@@.@..@@@@@@@@@.@...@....@@@@@@@@..@@.@..@.
@@.@@@@..@@@.@@@@.@..@@@..@.@..@@.@@@.@@..@.@@@@@@.@@@@.@@@.@@@.@.@@..@.@@@...@@@@..@..@@@..@@@@@@..@@@@@@@@@@.@@@@@@.@.@@.@@.@@.@..@@.@
@..@...@@.@@@@@@@@@@@@..@@....@@.@..@@@.@@......@.@@.@@@..@@@..@.@.@..@.@@@.@.@@@..@@@.@@@@@@@@@.@@.@@@@@.@@@@.@.@@.@.@@@@@@@@.@@@.@@.@.
.@.@@@@@@..@.@@@..@@@@@@@@.@.@@@@@@@..@@.@@.@.@.@@@@@.@@...@..@.@@@@@@@@.@.@@@@.@@...@@@@..@.@.@@..@..@.@..@..@..@@@@.@@@@@@@.@@.@.@.@@.
.@@@@@@.@@@.@@.@.@@@@@.@.@@@@@@@.@@@.@@@..@@@.@@@@@@@.@.@@@@.@@@.@@@.@.@@@...@.@@@@@...@@.@@@@@.@@@@@@@@@@.@@@@@@@@@@.@@@.@.@@@.@@@@.@@.
@@...@..@....@@@.@.@.@@..@.@...@..@.@.@@@@@.@.@@.@@@@@..@@@@@.@....@@@@..@@...@@...@..@@@@@@@@@@..@@@@.@@@@.@..@.@@@@....@.@@@@@.@@@.@@@
.@@@@..@@@.@.@@..@@@@@.@@..@@.@@@@@@.@@@@.@@@.@...@@@...@@@@@@@@@@.@@.@@@@.@@.....@@@@@..@...@......@....@@.@....@.@@@..@@.@@..@@.@..@@@
.@@..@@@....@@.@...@@@@..@@@@...@@.@@.@@.@@.@@.@@@@@@.@.@@@...@@.@@@@.@@....@@@..@.@@.@.@@@....@..@@.@@.@@@@@.@@@.@.@@@@@@@.@.@.@@.@.@@@
.@@@@@.@.@@.@@@.@@.@.@.@@@.@...@@@@.@@..@..@@@@@@@@.@@@..@@@..@@.@..@@@@@@.@@@@@...@...@.@..@@@@@.@@@@@@.@@.@..@@..@..@@.@..@@@..@.@.@..
.@@..@@@@......@@@..@@@@@@@@@@@@@.@.@..@@.@@@@@@.@@@.@@@..@@@.@...@@..@@@@.@@@...@@@@@@......@.@@@@@@.@..@.@@.@.@.@@@@@@.@.@@.@@@@.@.@.@
@@.....@.@@.@@@@@@.@.@@.@.@@.@.@@@@@@@.@.@@.@@@....@@.@@.@@@..@@.@@@@@...@@@@@@.@@.@..@@.@@..@.@@.@..@@@.@@@@@.@@@@@@.@@@@..@@..@@@@@...
..@..@@..@.@.@@@.@@@@@.@.@.@@@@..@@@...@@@@@.@@@.@.@@@.@@@@@@@@@@@@@...@.@.@@@.@@.@.@@.@@@@@@@@@@..@@.@@.@@@@@@@@@@@@.@..@.@@@.@@@...@@.
@@@...@.@.@@.@@..@@.@.@@@.@@@@@@@@@@.@@@@@@@@..@.@@@@.@@@@@@@..@@@@@@@..@@@.@.@@.@@@@.@.@...@@..@@@.@..@.@@@@@.@@@.@@@@@@.@@@@..@@.@..@@
"""
